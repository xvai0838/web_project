import{_ as Y,r as c,o as J,a as K,c as a,b as s,d as r,F as x,e as S,t as i,w as _,u as O,f as l,n as Q,g as X}from"./index-D_xQVRzG.js";import{i as f,v as Z,g as ss,d as es,a as ts}from"./userApi-_ZDq3u6c.js";const as={class:"welcome-page"},ls={class:"background-carousel"},os={class:"toolbar"},ns=["href"],is={class:"toolbar-icon"},cs={class:"toolbar-name"},rs=["src"],us={key:1,class:"avatar-placeholder"},ds={key:0,class:"history-panel"},ms={class:"history-header"},vs={class:"history-list"},ps={key:0,class:"empty-tip"},hs={key:1,class:"empty-tip"},gs=["src","onClick"],ys=["onClick"],_s={class:"history-type"},fs={class:"history-time"},ks=["onClick"],bs={class:"image-viewer-content"},ws={class:"viewer-image-container"},Is=["src"],Cs={class:"detail-content"},$s={class:"detail-date"},Ds={class:"detail-images"},Hs={class:"detail-image-box"},xs=["src"],Ss={class:"detail-image-box"},Rs=["src"],Ms={key:0,class:"detail-analysis"},Vs={class:"analysis-item"},As={class:"analysis-item"},Us={class:"analysis-item"},qs={class:"analysis-item"},Bs={class:"analysis-item"},Ls={key:0,class:"analysis-item"},Ps="https://api.gemai.cc",Ts={__name:"WelcomePage",setup(zs){const m=O(),k=c(""),b=c(!1),v=c(!1),p=c([]),w=c(!1),t=c(null),I=c(!1),C=c(""),R=c(["https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1920&q=80","https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=1920&q=80","https://images.unsplash.com/photo-1426604966848-d7adac402bff?w=1920&q=80"]),$=c(0);let D=null;const z=c([{name:"æ— æŸéŸ³ä¹",icon:"ğŸµ",url:"https://www.flac.life/"},{name:"drivenlisten",icon:"ğŸ–¼ï¸",url:"https://drivenlisten.com/city"},{name:"Yandex",icon:"ğŸŒ",url:"https://yandex.eu"},{name:"GitHub",icon:"ğŸ’»",url:"https://github.com"}]),F=()=>{$.value=($.value+1)%R.value.length},N=()=>{f()?m.push("/app"):m.push("/login")},W=()=>{f()?m.push("/user-profile"):m.push("/login")},j=async()=>{if(!f()){m.push("/login");return}v.value=!v.value,v.value&&await M()},M=async()=>{try{const o=await ts();p.value=o.sort((e,d)=>d.timestamp-e.timestamp)}catch(o){console.error("åŠ è½½å†å²è®°å½•å¤±è´¥:",o)}},V=o=>{const e=new Date(o),d=e.getMonth()+1,h=e.getDate(),g=e.getHours().toString().padStart(2,"0"),y=e.getMinutes().toString().padStart(2,"0");return`${d}æœˆ${h}æ—¥ ${g}:${y}`},E=async o=>{if(confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡å†å²è®°å½•å—ï¼Ÿ"))try{await es(o),await M()}catch(e){alert("åˆ é™¤å¤±è´¥: "+e.message)}},G=o=>{t.value=o,w.value=!0},A=()=>{w.value=!1,t.value=null},H=o=>{C.value=o,I.value=!0},U=()=>{I.value=!1,C.value=""};return J(async()=>{if(D=setInterval(F,5e3),f()){b.value=!0;try{await Z();const o=ss();o!=null&&o.avatar&&(k.value=o.avatar)}catch{}}}),K(()=>{D&&clearInterval(D)}),(o,e)=>{var d,h,g,y,q,B,L;return l(),a("div",as,[s("div",ls,[(l(!0),a(x,null,S(R.value,(n,u)=>(l(),a("div",{key:u,class:X(["background-image",{active:$.value===u}]),style:Q({backgroundImage:`url(${n})`})},null,6))),128))]),s("div",os,[(l(!0),a(x,null,S(z.value,(n,u)=>(l(),a("a",{key:u,href:n.url,target:"_blank",class:"toolbar-item"},[s("span",is,i(n.icon),1),s("span",cs,i(n.name),1)],8,ns))),128))]),s("div",{class:"profile-btn",onClick:W},[k.value?(l(),a("img",{key:0,src:k.value,alt:"å¤´åƒ",class:"avatar-img"},null,8,rs)):(l(),a("span",us,"ğŸ‘¤"))]),s("button",{class:"history-btn",onClick:j}," ğŸ“‹ å†å²è®°å½• "),v.value?(l(),a("div",ds,[s("div",ms,[s("h3",null,"å†å²è®°å½• ("+i(p.value.length)+"/50)",1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=n=>v.value=!1)},"Ã—")]),s("div",vs,[b.value?p.value.length===0?(l(),a("p",hs,"æš‚æ— å†å²è®°å½•")):r("",!0):(l(),a("p",ps,"è¯·å…ˆç™»å½•æŸ¥çœ‹å†å²è®°å½•")),(l(!0),a(x,null,S(p.value,n=>{var u,P;return l(),a("div",{key:n.id,class:"history-item"},[s("img",{src:n.imageData,alt:"å†å²å›¾ç‰‡",class:"history-thumb",onClick:_(T=>H(n.imageData),["stop"])},null,8,gs),s("div",{class:"history-info",onClick:T=>G(n)},[s("p",_s,i(((P=(u=n.result)==null?void 0:u.composition)==null?void 0:P.type)||"æœªçŸ¥æ„å›¾"),1),s("p",fs,i(V(n.timestamp)),1)],8,ys),s("button",{class:"delete-history-btn",onClick:_(T=>E(n.id),["stop"]),title:"åˆ é™¤"},"ğŸ—‘ï¸",8,ks)])}),128))])])):r("",!0),I.value?(l(),a("div",{key:1,class:"image-viewer-modal",onClick:_(U,["self"])},[s("div",bs,[s("button",{class:"viewer-close-btn",onClick:U},"Ã—"),s("div",ws,[s("img",{src:C.value},null,8,Is)])])])):r("",!0),w.value?(l(),a("div",{key:2,class:"detail-modal",onClick:_(A,["self"])},[s("div",Cs,[s("button",{class:"detail-close-btn",onClick:A},"Ã—"),s("h3",null,i(((g=(h=(d=t.value)==null?void 0:d.result)==null?void 0:h.composition)==null?void 0:g.type)||"å›¾ç‰‡åˆ†æ"),1),s("p",$s,i(t.value?V(t.value.timestamp):""),1),s("div",Ds,[s("div",Hs,[e[3]||(e[3]=s("h4",null,"åŸå›¾",-1)),(y=t.value)!=null&&y.imageData?(l(),a("img",{key:0,src:t.value.imageData,alt:"åŸå›¾",onClick:e[1]||(e[1]=n=>H(t.value.imageData)),class:"clickable-image"},null,8,xs)):r("",!0)]),s("div",Ss,[e[4]||(e[4]=s("h4",null,"åˆ†æå›¾",-1)),(q=t.value)!=null&&q.analysisImage?(l(),a("img",{key:0,src:t.value.analysisImage,alt:"åˆ†æå›¾",onClick:e[2]||(e[2]=n=>H(t.value.analysisImage)),class:"clickable-image"},null,8,Rs)):r("",!0)])]),(B=t.value)!=null&&B.result?(l(),a("div",Ms,[s("div",Vs,[e[5]||(e[5]=s("h4",null,"ğŸ“ æ„å›¾åˆ†æ",-1)),s("p",null,i(((L=t.value.result.composition)==null?void 0:L.description)||"æ— "),1)]),s("div",As,[e[6]||(e[6]=s("h4",null,"ğŸ’¡ å…‰çº¿åˆ†æ",-1)),s("p",null,i(t.value.result.lighting||"æ— "),1)]),s("div",Us,[e[7]||(e[7]=s("h4",null,"ğŸ¨ è‰²å½©åˆ†æ",-1)),s("p",null,i(t.value.result.color||"æ— "),1)]),s("div",qs,[e[8]||(e[8]=s("h4",null,"ğŸ¯ ä¸»ä½“è¡¨è¾¾",-1)),s("p",null,i(t.value.result.subject||"æ— "),1)]),s("div",Bs,[e[9]||(e[9]=s("h4",null,"ğŸ“· æ™¯åˆ«ä¸è§’åº¦",-1)),s("p",null,i(t.value.result.perspective||"æ— "),1)]),t.value.result.improvement?(l(),a("div",Ls,[e[10]||(e[10]=s("h4",null,"ğŸ’¡ ä¸è¶³ä¸æå‡",-1)),s("p",null,i(t.value.result.improvement),1)])):r("",!0)])):r("",!0)])])):r("",!0),s("button",{class:"start-button",onClick:N}," å¼€å§‹ä½¿ç”¨ "),b.value?(l(),a("a",{key:3,href:Ps,target:"_blank",class:"more-models-btn"},[...e[11]||(e[11]=[s("span",{class:"more-models-icon"},"ğŸ™",-1),s("span",{class:"more-models-text"},"æ›´å¤šå…è´¹æ¨¡å‹",-1)])])):r("",!0)])}}},Ws=Y(Ts,[["__scopeId","data-v-ca45eddc"]]);export{Ws as default};
